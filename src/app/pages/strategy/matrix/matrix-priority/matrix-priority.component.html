<!-- <h1>Matriz de {{state.nombre}}</h1>
<hr>

<div *ngIf="loading; else notShow">
  <h4>LOADING</h4>
</div>
<ng-template #notShow>
<div class="table-wrapper">
<div align="right">
  <button mat-icon-button color="success"(click)="refresh()">
      <mat-icon>refresh</mat-icon>
  </button>
  <button mat-raised-button color="primary" (click)="invertir()">Invertir Orden</button>
  <p-toast position="top-center"></p-toast>
  <mat-form-field appearance="fill">
    <mat-label>Filtro por prioridad Actor</mat-label>
    <mat-select [(value)]="selectedActor">
      <mat-option value =0>Ninguno</mat-option>
      <mat-option value=1>Prioridad 1</mat-option>
      <mat-option value=2>Prioridad 2</mat-option>
      <mat-option value=3>Prioridad 3</mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Filtro por prioridad Tema</mat-label>
    <mat-select [(value)]="selectedTema">
      <mat-option value =0>Ninguno</mat-option>
      <mat-option value=1>Prioridad 1</mat-option>
      <mat-option value=2>Prioridad 2</mat-option>
      <mat-option value=3>Prioridad 3</mat-option>
    </mat-select>
  </mat-form-field>
</div>
<div *ngIf = "invert; else change">
  <table class="fl-table">
    <thead>
      <tr>
        <th rowspan="4" colspan="4">
          <div class="center">
            Temas/Actores
          </div>
        </th>
      <ng-container *ngFor="let item of Matriz.Actores; let i = index">
        <ng-container *ngIf = "item.hijos?.length; else padre">
          <th [attr.colspan]="maxcolspan(item)">{{item.name}}</th>
        </ng-container>
        <ng-template #padre>
          <th rowspan="4">{{item.name}}</th>
        </ng-template>
      </ng-container>
      </tr>
      <tr>
      <ng-container *ngFor="let item of Matriz.Actores" >
        <ng-container *ngIf = "item.hijos?.length">
          <ng-container *ngFor="let hijo of item.hijos">
          <ng-container *ngIf = "hijo.hijos?.length == 0; else subhijo">
            <th rowspan="3">{{hijo.name}} </th>
          </ng-container>
          <ng-template #subhijo>
            <th [attr.colspan]="maxcolspan(item)  ">{{hijo.name}} {{hijo.hijos?.length}}</th>
          </ng-template>
          </ng-container>     
        </ng-container>
      </ng-container>
     </tr>
     <tr>
      <ng-container *ngFor="let item of Matriz.Actores" >
        <ng-container *ngIf = "item.hijos?.length">
          <ng-container *ngFor="let hijo of item.hijos">
            <ng-container *ngFor="let subhijo of hijo.hijos">
            <ng-container *ngIf = "subhijo.hijos?.length == 0; else subhijo1">
              <th rowspan="2">{{subhijo.name}}</th>
            </ng-container>
            <ng-template #subhijo1>
              <th [attr.colspan]="maxcolspan(item)">{{subhijo.name}}</th>
            </ng-template>
            </ng-container>
          </ng-container>     
        </ng-container>
      </ng-container>
     </tr>
     <tr>
      <ng-container *ngFor="let item of Matriz.Actores" >
        <ng-container *ngIf = "item.hijos?.length">
          <ng-container *ngFor="let hijo of item.hijos">
            <ng-container *ngFor="let subhijo of hijo.hijos">
            <ng-container *ngFor = "let subhijo2 of subhijo.hijos">
              <th>{{subhijo2.name}}</th>
            </ng-container>
            </ng-container>
          </ng-container>     
        </ng-container>
      </ng-container>
     </tr>
    </thead> -->
    <!-- <tbody *ngFor="let item of Matriz.Temas; let i = index">
      <ng-container *ngIf = "item.hijos?.length; else padre">
        <tr>
          <th [attr.rowspan]="maxrowspan(item)">{{item.name}}</th>
          <ng-container *ngIf = "item.hijos[0].hijos?.length; else subhijoCabezera">
            <th [attr.rowspan]="maxrowspan(item)"> {{item.hijos[0].name}}</th>
            <ng-container *ngIf = "item.hijos[0].hijos[0].hijos?.length; else subsubhijoCabezera">
              <th [attr.rowspan]="item.hijos[0].hijos[0].hijos?.length"> {{item.hijos[0].hijos[0].name}}</th>
              <th>{{item.hijos[0].hijos[0].hijos[0].name}}</th>
              <ng-container *ngFor="let cell of Matriz.Celdas">
                <ng-container *ngIf = "item.hijos[0].hijos[0].hijos[0].id == cell.TemaParent.id">
                  <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                    <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                      <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                        <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                        <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                    <br>
                    <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                      <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        <img src="assets/img/courtblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                        <img src="assets/img/moyenblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                        <img src="assets/img/longblack.gif" />    
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                  </td>
                </ng-container>
              </ng-container>
            </ng-container>
          </ng-container>
        </tr>
        <ng-container *ngFor="let hijo of item.hijos; let a = index">
          <ng-container *ngIf = "a != 0">
            <ng-container *ngIf = "hijo.hijos?.length; else subhijoBody">
              <tr>
                <th [attr.rowspan]="maxrowspan(item)-1">{{hijo.name}}</th>
                <ng-container *ngIf = "hijo.hijos[0].hijos.length; else ultimo">
                  <th [attr.rowspan]="hijo.hijos[0].hijos.length">{{hijo.hijos[0].name}}</th>
                  <th>{{hijo.hijos[0].hijos[0].name}}</th>
                  <ng-container *ngFor="let cell of Matriz.Celdas">
                    <ng-container *ngIf = "hijo.hijos[0].hijos[0].id == cell.TemaParent.id">
                      <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                        <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                          <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                            N/A
                          </mat-button-toggle>
                          <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                            <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                          </mat-button-toggle>
                          <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                            <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                          </mat-button-toggle>
                          <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                            <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                          </mat-button-toggle>
                        </mat-button-toggle-group>
                        <br>
                        <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                          <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                            N/A
                          </mat-button-toggle>
                          <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                            <img src="assets/img/courtblack.gif" />
                          </mat-button-toggle>
                          <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                            <img src="assets/img/moyenblack.gif" />
                          </mat-button-toggle>
                          <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                            <img src="assets/img/longblack.gif" />    
                          </mat-button-toggle>
                        </mat-button-toggle-group>
                      </td>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </tr>
              <ng-template #ultimo>
                <th colspan="2">{{hijo.hijos[0].name}}</th>
                <ng-container *ngFor="let cell of Matriz.Celdas">
                  <ng-container *ngIf = "hijo.hijos[0].id == cell.TemaParent.id">
                    <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                      <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                        <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                          <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                          <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                      <br>
                      <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                        <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          <img src="assets/img/courtblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                          <img src="assets/img/moyenblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                          <img src="assets/img/longblack.gif" />    
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                    </td>
                  </ng-container>
                </ng-container>
              </ng-template>
            </ng-container>
          </ng-container>
          <ng-container *ngFor="let subhijo of hijo.hijos; let b = index">
              <ng-container *ngIf = "b != 0; else Prueba">
                <ng-container *ngIf = "subhijo.hijos?.length; else subsubhijoBody">
                  <tr>
                    <th [attr.rowspan]="subhijo.hijos?.length" >{{subhijo.name}} </th>
                    <th>{{subhijo.hijos[0].name}}</th>
                    <ng-container *ngFor="let cell of Matriz.Celdas">
                      <ng-container *ngIf = "subhijo.hijos[0].id == cell.TemaParent.id">
                        <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                          <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                            <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                              <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                              <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                          <br>
                          <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                            <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              <img src="assets/img/courtblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                              <img src="assets/img/moyenblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                              <img src="assets/img/longblack.gif" />    
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                        </td>
                      </ng-container>
                    </ng-container>
                  </tr>
                  <ng-container *ngFor = "let subhijo1 of subhijo.hijos; let c = index">
                    <ng-container *ngIf = "c != 0;">
                      <tr>
                        <th>{{subhijo1.name}}</th>
                        <ng-container *ngFor="let cell of Matriz.Celdas">
                          <ng-container *ngIf = "subhijo1.id == cell.TemaParent.id">
                            <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                              <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                                <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                                  N/A
                                </mat-button-toggle>
                                <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                                  <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                                </mat-button-toggle>
                                <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                                  <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                                </mat-button-toggle>
                                <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                                  <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                                </mat-button-toggle>
                              </mat-button-toggle-group>
                              <br>
                              <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                                <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                                  N/A
                                </mat-button-toggle>
                                <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                                  <img src="assets/img/courtblack.gif" />
                                </mat-button-toggle>
                                <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                                  <img src="assets/img/moyenblack.gif" />
                                </mat-button-toggle>
                                <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                                  <img src="assets/img/longblack.gif" />    
                                </mat-button-toggle>
                              </mat-button-toggle-group>
                            </td>
                          </ng-container>
                        </ng-container>
                      </tr>
                    </ng-container>
                  </ng-container>
                </ng-container>
            </ng-container> -->
            <!-- <ng-template #subsubhijoBody>
              <tr>
                <th colspan="2">{{subhijo.name}}</th>
                <ng-container *ngFor="let cell of Matriz.Celdas">
                  <ng-container *ngIf = "subhijo.id == cell.TemaParent.id">
                    <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                      <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                        <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                          <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                          <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                      <br>
                      <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                        <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          <img src="assets/img/courtblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                          <img src="assets/img/moyenblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                          <img src="assets/img/longblack.gif" />    
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                    </td>
                  </ng-container>
                </ng-container>
              </tr>
            </ng-template>
            <ng-template #Prueba>
              <ng-container *ngIf="subhijo.hijos?.length >1">
                <ng-container *ngFor = "let subhijo1 of subhijo.hijos; let c = index">
                  <ng-container *ngIf = "c != 0">
                    <th>{{subhijo1.name}}</th>
                    <ng-container *ngFor="let cell of Matriz.Celdas">
                      <ng-container *ngIf = "subhijo1.id == cell.TemaParent.id">
                        <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                          <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                            <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                              <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                              <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                          <br>
                          <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                            <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              <img src="assets/img/courtblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                              <img src="assets/img/moyenblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                              <img src="assets/img/longblack.gif" />    
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                        </td>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </ng-container>
            </ng-template>
          </ng-container>
          <ng-template #subhijoBody>
            <tr>
              <th colspan="3"> {{hijo.name}}</th>
              <ng-container *ngFor="let cell of Matriz.Celdas">
                <ng-container *ngIf = "hijo.id == cell.TemaParent.id">
                  <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                    <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                      <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                        <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                        <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                    <br>
                    <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                      <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        <img src="assets/img/courtblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                        <img src="assets/img/moyenblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                        <img src="assets/img/longblack.gif" />    
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                  </td>
                </ng-container>
              </ng-container>
            </tr>  
          </ng-template>
        </ng-container>
      </ng-container>
      <ng-template #subhijoCabezera>
        <th colspan="3"> {{item.hijos[0].name}}</th>
        <ng-container *ngFor="let cell of Matriz.Celdas">
          <ng-container *ngIf = "item.hijos[0].id == cell.TemaParent.id">
            <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
              <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                  <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                  <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
              </mat-button-toggle-group>
              <br>
              <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  <img src="assets/img/courtblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                  <img src="assets/img/moyenblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                  <img src="assets/img/longblack.gif" />    
                </mat-button-toggle>
              </mat-button-toggle-group>
            </td>
          </ng-container>
        </ng-container>
      </ng-template>
      <ng-template #subsubhijoCabezera>
        <th colspan="2"> {{item.hijos[0].hijos[0].name}} </th>
        <ng-container *ngFor="let cell of Matriz.Celdas">
          <ng-container *ngIf = "item.hijos[0].hijos[0].id == cell.TemaParent.id">
            <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
              <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                  <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                  <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
              </mat-button-toggle-group>
              <br>
              <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  <img src="assets/img/courtblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                  <img src="assets/img/moyenblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                  <img src="assets/img/longblack.gif" />    
                </mat-button-toggle>
              </mat-button-toggle-group>
            </td>
          </ng-container>
        </ng-container>
      </ng-template>
      <ng-template #padre>
        <tr>
          <th colspan="4">
            {{item.name}}
          </th>
          <ng-container *ngFor="let cell of Matriz.Celdas">
            <ng-container *ngIf = "item.id == cell.TemaParent.id">
              <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                  <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                    N/A
                  </mat-button-toggle>
                  <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                    <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                  </mat-button-toggle>
                  <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                    <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                  </mat-button-toggle>
                  <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                    <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                  </mat-button-toggle>
                </mat-button-toggle-group>
                <br>
                <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                  <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                    N/A
                  </mat-button-toggle>
                  <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                    <img src="assets/img/courtblack.gif" />
                  </mat-button-toggle>
                  <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                    <img src="assets/img/moyenblack.gif" />
                  </mat-button-toggle>
                  <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                    <img src="assets/img/longblack.gif" />    
                  </mat-button-toggle>
                </mat-button-toggle-group>
              </td>
            </ng-container>
          </ng-container>
        </tr>
      </ng-template>
    </tbody>
  </table>  
</div> -->
<!-- <ng-template #change>
  <table class="fl-table">
    <thead>
      <tr>
        <th rowspan="4" colspan="4">
          <div class="center">
            Actores/Temas
          </div>
        </th>
      <ng-container *ngFor="let item of Matriz.Temas; let i = index">
        <ng-container *ngIf = "item.hijos?.length; else padre">
          <th [attr.colspan]="maxcolspan(item)">{{item.name}}</th>
        </ng-container>
        <ng-template #padre>
          <th rowspan="4">{{item.name}}</th>
        </ng-template>
      </ng-container>
      </tr>
      <tr>
      <ng-container *ngFor="let item of Matriz.Temas" >
        <ng-container *ngIf = "item.hijos?.length">
          <ng-container *ngFor="let hijo of item.hijos">
          <ng-container *ngIf = "hijo.hijos?.length == 0; else subhijo">
            <th rowspan="3">{{hijo.name}} </th>
          </ng-container>
          <ng-template #subhijo>
            <th [attr.colspan]="maxcolspan(item)  ">{{hijo.name}} {{hijo.hijos?.length}}</th>
          </ng-template>
          </ng-container>     
        </ng-container>
      </ng-container>
     </tr>
     <tr>
      <ng-container *ngFor="let item of Matriz.Temas" >
        <ng-container *ngIf = "item.hijos?.length">
          <ng-container *ngFor="let hijo of item.hijos">
            <ng-container *ngFor="let subhijo of hijo.hijos">
            <ng-container *ngIf = "subhijo.hijos?.length == 0; else subhijo1">
              <th rowspan="2">{{subhijo.name}}</th>
            </ng-container>
            <ng-template #subhijo1>
              <th [attr.colspan]="maxcolspan(item)">{{subhijo.name}}</th>
            </ng-template>
            </ng-container>
          </ng-container>     
        </ng-container>
      </ng-container>
     </tr>
     <tr>
      <ng-container *ngFor="let item of Matriz.Temas" >
        <ng-container *ngIf = "item.hijos?.length">
          <ng-container *ngFor="let hijo of item.hijos">
            <ng-container *ngFor="let subhijo of hijo.hijos">
            <ng-container *ngFor = "let subhijo2 of subhijo.hijos">
              <th>{{subhijo2.name}}</th>
            </ng-container>
            </ng-container>
          </ng-container>     
        </ng-container>
      </ng-container>
     </tr>
    </thead>
    <tbody *ngFor="let item of Matriz.Actores; let i = index">
      <ng-container *ngIf = "item.hijos?.length; else padre">
        <tr style="height:100px">
          <th [attr.rowspan]="maxrowspan(item)">{{item.name}}</th>
          <ng-container *ngIf = "item.hijos[0].hijos?.length; else subhijoCabezera">
            <th [attr.rowspan]="maxrowspan(item)"> {{item.hijos[0].name}}</th>
            <ng-container *ngIf = "item.hijos[0].hijos[0].hijos?.length; else subsubhijoCabezera">
              <th [attr.rowspan]="item.hijos[0].hijos[0].hijos?.length"> {{item.hijos[0].hijos[0].name}}</th>
              <th>{{item.hijos[0].hijos[0].hijos[0].name}}</th>
              <ng-container *ngFor="let cell of Matriz.Celdas">
                <ng-container *ngIf = "item.hijos[0].hijos[0].hijos[0].id == cell.ActorParent.id">
                  <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                    <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                      <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                        <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                        <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                    <br>
                    <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                      <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        <img src="assets/img/courtblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                        <img src="assets/img/moyenblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                        <img src="assets/img/longblack.gif" />    
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                  </td>
                </ng-container>
              </ng-container>
            </ng-container>
          </ng-container>
        </tr>
        <ng-container *ngFor="let hijo of item.hijos; let a = index">
          <ng-container *ngIf = "a != 0">
            <ng-container *ngIf = "hijo.hijos?.length; else subhijoBody">
              <tr>
                <th [attr.rowspan]="maxrowspan(item)-1">{{hijo.name}}</th>
                <ng-container *ngIf = "hijo.hijos[0].hijos.length; else ultimo">
                  <th [attr.rowspan]="hijo.hijos[0].hijos.length">{{hijo.hijos[0].name}}</th>
                  <th>{{hijo.hijos[0].hijos[0].name}}</th>
                  <ng-container *ngFor="let cell of Matriz.Celdas">
                    <ng-container *ngIf = "hijo.hijos[0].hijos[0].id == cell.ActorParent.id">
                      <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                        <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                          <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                            N/A
                          </mat-button-toggle>
                          <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                            <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                          </mat-button-toggle>
                          <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                            <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                          </mat-button-toggle>
                          <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                            <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                          </mat-button-toggle>
                        </mat-button-toggle-group>
                        <br>
                        <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                          <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                            N/A
                          </mat-button-toggle>
                          <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                            <img src="assets/img/courtblack.gif" />
                          </mat-button-toggle>
                          <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                            <img src="assets/img/moyenblack.gif" />
                          </mat-button-toggle>
                          <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                            <img src="assets/img/longblack.gif" />    
                          </mat-button-toggle>
                        </mat-button-toggle-group>
                      </td>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </tr>
              <ng-template #ultimo>
                <th colspan="2">{{hijo.hijos[0].name}}</th>
                <ng-container *ngFor="let cell of Matriz.Celdas">
                  <ng-container *ngIf = "hijo.hijos[0].id == cell.ActorParent.id">
                    <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                      <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                        <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                          <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                          <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                      <br>
                      <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                        <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          <img src="assets/img/courtblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                          <img src="assets/img/moyenblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                          <img src="assets/img/longblack.gif" />    
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                    </td>
                  </ng-container>
                </ng-container>
              </ng-template>
            </ng-container>
          </ng-container>
          <ng-container *ngFor="let subhijo of hijo.hijos; let b = index">
              <ng-container *ngIf = "b != 0; else Prueba">
                <ng-container *ngIf = "subhijo.hijos?.length; else subsubhijoBody">
                  <tr>
                    <th [attr.rowspan]="subhijo.hijos?.length" >{{subhijo.name}} </th>
                    <th>{{subhijo.hijos[0].name}}</th>
                    <ng-container *ngFor="let cell of Matriz.Celdas">
                      <ng-container *ngIf = "subhijo.hijos[0].id == cell.ActorParent.id">
                        <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                          <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                            <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                              <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                              <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                          <br>
                          <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                            <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              <img src="assets/img/courtblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                              <img src="assets/img/moyenblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                              <img src="assets/img/longblack.gif" />    
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                        </td>
                      </ng-container>
                    </ng-container>
                  </tr>
                  <ng-container *ngFor = "let subhijo1 of subhijo.hijos; let c = index">
                    <ng-container *ngIf = "c != 0;">
                      <tr>
                        <th>{{subhijo1.name}}</th>
                        <ng-container *ngFor="let cell of Matriz.Celdas">
                          <ng-container *ngIf = "subhijo1.id == cell.ActorParent.id">
                            <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                              <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                                <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                                  N/A
                                </mat-button-toggle>
                                <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                                  <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                                </mat-button-toggle>
                                <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                                  <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                                </mat-button-toggle>
                                <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                                  <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                                </mat-button-toggle>
                              </mat-button-toggle-group>
                              <br>
                              <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                                <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                                  N/A
                                </mat-button-toggle>
                                <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                                  <img src="assets/img/courtblack.gif" />
                                </mat-button-toggle>
                                <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                                  <img src="assets/img/moyenblack.gif" />
                                </mat-button-toggle>
                                <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                                  <img src="assets/img/longblack.gif" />    
                                </mat-button-toggle>
                              </mat-button-toggle-group>
                            </td>
                          </ng-container>
                        </ng-container>
                      </tr>
                    </ng-container>
                  </ng-container>
                </ng-container>
            </ng-container>
            <ng-template #subsubhijoBody>
              <tr>
                <th colspan="2">{{subhijo.name}}</th>
                <ng-container *ngFor="let cell of Matriz.Celdas">
                  <ng-container *ngIf = "subhijo.id == cell.ActorParent.id">
                    <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                      <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                        <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                          <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                          <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                          <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                      <br>
                      <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                        <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          N/A
                        </mat-button-toggle>
                        <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                          <img src="assets/img/courtblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                          <img src="assets/img/moyenblack.gif" />
                        </mat-button-toggle>
                        <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                          <img src="assets/img/longblack.gif" />    
                        </mat-button-toggle>
                      </mat-button-toggle-group>
                    </td>
                  </ng-container>
                </ng-container>
              </tr>
            </ng-template>
            <ng-template #Prueba>
              <ng-container *ngIf="subhijo.hijos?.length >1">
                <ng-container *ngFor = "let subhijo1 of subhijo.hijos; let c = index">
                  <ng-container *ngIf = "c != 0">
                    <th>{{subhijo1.name}}</th>
                    <ng-container *ngFor="let cell of Matriz.Celdas">
                      <ng-container *ngIf = "subhijo1.id == cell.ActorParent.id">
                        <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                          <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                            <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                              <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                              <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                              <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                          <br>
                          <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                            <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              N/A
                            </mat-button-toggle>
                            <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                              <img src="assets/img/courtblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                              <img src="assets/img/moyenblack.gif" />
                            </mat-button-toggle>
                            <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                              <img src="assets/img/longblack.gif" />    
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                        </td>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </ng-container>
            </ng-template>
          </ng-container>
          <ng-template #subhijoBody>
            <tr>
              <th colspan="3"> {{hijo.name}}</th>
              <ng-container *ngFor="let cell of Matriz.Celdas">
                <ng-container *ngIf = "hijo.id == cell.ActorParent.id">
                  <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                    <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                      <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                        <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                        <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                        <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                    <br>
                    <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                      <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        N/A
                      </mat-button-toggle>
                      <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                        <img src="assets/img/courtblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                        <img src="assets/img/moyenblack.gif" />
                      </mat-button-toggle>
                      <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                        <img src="assets/img/longblack.gif" />    
                      </mat-button-toggle>
                    </mat-button-toggle-group>
                  </td>
                </ng-container>
              </ng-container>
            </tr>  
          </ng-template>
        </ng-container>
      </ng-container> -->
      <!-- <ng-template #subhijoCabezera>
        <th colspan="3"> {{item.hijos[0].name}}</th>
        <ng-container *ngFor="let cell of Matriz.Celdas">
          <ng-container *ngIf = "item.hijos[0].id == cell.ActorParent.id">
            <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
              <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                  <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                  <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
              </mat-button-toggle-group>
              <br>
              <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  <img src="assets/img/courtblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                  <img src="assets/img/moyenblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                  <img src="assets/img/longblack.gif" />    
                </mat-button-toggle>
              </mat-button-toggle-group>
            </td>
          </ng-container>
        </ng-container>
      </ng-template>
      <ng-template #subsubhijoCabezera>
        <th colspan="2"> {{item.hijos[0].hijos[0].name}} </th>
        <ng-container *ngFor="let cell of Matriz.Celdas">
          <ng-container *ngIf = "item.hijos[0].hijos[0].id == cell.ActorParent.id">
            <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
              <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                  <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                  <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                  <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                </mat-button-toggle>
              </mat-button-toggle-group>
              <br>
              <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  N/A
                </mat-button-toggle>
                <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                  <img src="assets/img/courtblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                  <img src="assets/img/moyenblack.gif" />
                </mat-button-toggle>
                <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                  <img src="assets/img/longblack.gif" />    
                </mat-button-toggle>
              </mat-button-toggle-group>
            </td>
          </ng-container>
        </ng-container>
      </ng-template>
      <ng-template #padre>
        <tr>
          <th colspan="4">
            {{item.name}}
          </th>
          <ng-container *ngFor="let cell of Matriz.Celdas">
            <ng-container *ngIf = "item.id == cell.ActorParent.id">
              <td [ngClass]="{'selected' : (cell.ActorParent.prioridad == selectedActor && cell.TemaParent.prioridad == selectedTema) && selectedActor != 0 && selectedTema != 0}">
                <mat-button-toggle-group #group="matButtonToggleGroup" value="{{cell.prioridad}}">
                  <mat-button-toggle value="0" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                    N/A
                  </mat-button-toggle>
                  <mat-button-toggle value="1" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align left">
                    <mat-icon class="green-icon">fiber_manual_record</mat-icon>
                  </mat-button-toggle>
                  <mat-button-toggle value="2" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align center">
                    <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
                  </mat-button-toggle>
                  <mat-button-toggle value="3" (change)="onPrioridadChange($event.value,cell.id)" aria-label="Text align right">
                    <mat-icon class="red-icon">fiber_manual_record</mat-icon>
                  </mat-button-toggle>
                </mat-button-toggle-group>
                <br>
                <mat-button-toggle-group #grouptime="matButtonToggleGroup" value="{{cell.tiempo}}">
                  <mat-button-toggle value="0" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                    N/A
                  </mat-button-toggle>
                  <mat-button-toggle value="1" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align left">
                    <img src="assets/img/courtblack.gif" />
                  </mat-button-toggle>
                  <mat-button-toggle value="2" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align center">
                    <img src="assets/img/moyenblack.gif" />
                  </mat-button-toggle>
                  <mat-button-toggle value="3" (change)="onTimeChange($event.value,cell.id)" aria-label="Text align right">
                    <img src="assets/img/longblack.gif" />    
                  </mat-button-toggle>
                </mat-button-toggle-group>
              </td>
            </ng-container>
          </ng-container>
        </tr>
      </ng-template>
    </tbody>
  </table>  
</ng-template>
<mat-button-toggle-group #grouptime="matButtonToggleGroup">
  <mat-button-toggle value="Bajo" aria-label="Text align left">
    <img src="assets/img/courtblack.gif" />
  </mat-button-toggle>
  <mat-button-toggle value="Medio" aria-label="Text align center">
    <img src="assets/img/moyenblack.gif" />
  </mat-button-toggle>
  <mat-button-toggle value="Alto" aria-label="Text align right">
    <img src="assets/img/longblack.gif" />    
  </mat-button-toggle>
</mat-button-toggle-group>
<span class="center" style="padding-right: 20px;">Tiempo: {{grouptime.value}}</span>
<mat-button-toggle-group #group="matButtonToggleGroup">
  <mat-button-toggle value="Baja" aria-label="Text align left">
    <mat-icon class="green-icon">fiber_manual_record</mat-icon>
  </mat-button-toggle>
  <mat-button-toggle value="Media" aria-label="Text align center">
    <mat-icon class="yellow-icon">fiber_manual_record</mat-icon>
  </mat-button-toggle>
  <mat-button-toggle value="Alta" aria-label="Text align right">
    <mat-icon class="red-icon">fiber_manual_record</mat-icon>
  </mat-button-toggle>
</mat-button-toggle-group>
<span class="center">Prioridad: {{group.value}}</span>
</div>

</ng-template>

 -->
